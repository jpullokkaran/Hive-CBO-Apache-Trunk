PREHOOK: query: create table over10k(
           t tinyint,
           si smallint,
           i int,
           b bigint,
           f float,
           d double,
           bo boolean,
           s string,
	   ts timestamp, 
           dec decimal(4,2),  
           bin binary)
       row format delimited
       fields terminated by '|'
PREHOOK: type: CREATETABLE
POSTHOOK: query: create table over10k(
           t tinyint,
           si smallint,
           i int,
           b bigint,
           f float,
           d double,
           bo boolean,
           s string,
	   ts timestamp, 
           dec decimal(4,2),  
           bin binary)
       row format delimited
       fields terminated by '|'
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@over10k
PREHOOK: query: load data local inpath '../../data/files/over10k' into table over10k
PREHOOK: type: LOAD
PREHOOK: Output: default@over10k
POSTHOOK: query: load data local inpath '../../data/files/over10k' into table over10k
POSTHOOK: type: LOAD
POSTHOOK: Output: default@over10k
PREHOOK: query: -- i ranges from 65536 to (65536 + 30)
-- with around 30-40 rows per value.

create table over1k as select * from over10k where i < 65536 + 30
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@over10k
POSTHOOK: query: -- i ranges from 65536 to (65536 + 30)
-- with around 30-40 rows per value.

create table over1k as select * from over10k where i < 65536 + 30
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@over10k
POSTHOOK: Output: default@over1k
PREHOOK: query: create table over500 as select * from over10k where i < 65536 + 15
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@over10k
POSTHOOK: query: create table over500 as select * from over10k where i < 65536 + 15
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@over10k
POSTHOOK: Output: default@over500
PREHOOK: query: create table over2k as select * from over10k where i < 65536 + 60
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@over10k
POSTHOOK: query: create table over2k as select * from over10k where i < 65536 + 60
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@over10k
POSTHOOK: Output: default@over2k
PREHOOK: query: create table over5k as select * from over10k where i < 65536 + 125
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@over10k
POSTHOOK: query: create table over5k as select * from over10k where i < 65536 + 125
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@over10k
POSTHOOK: Output: default@over5k
PREHOOK: query: -- set hive.stats.dbclass=jdbc:derby;
analyze table over10k compute statistics
PREHOOK: type: QUERY
PREHOOK: Input: default@over10k
PREHOOK: Output: default@over10k
POSTHOOK: query: -- set hive.stats.dbclass=jdbc:derby;
analyze table over10k compute statistics
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over10k
POSTHOOK: Output: default@over10k
PREHOOK: query: analyze table over10k compute statistics for columns t,si,i,b,f,d,bo,s
PREHOOK: type: QUERY
PREHOOK: Input: default@over10k
#### A masked pattern was here ####
POSTHOOK: query: analyze table over10k compute statistics for columns t,si,i,b,f,d,bo,s
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over10k
#### A masked pattern was here ####
PREHOOK: query: analyze table over1k compute statistics
PREHOOK: type: QUERY
PREHOOK: Input: default@over1k
PREHOOK: Output: default@over1k
POSTHOOK: query: analyze table over1k compute statistics
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over1k
POSTHOOK: Output: default@over1k
PREHOOK: query: analyze table over1k compute statistics for columns t,si,i,b,f,d,bo,s
PREHOOK: type: QUERY
PREHOOK: Input: default@over1k
#### A masked pattern was here ####
POSTHOOK: query: analyze table over1k compute statistics for columns t,si,i,b,f,d,bo,s
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over1k
#### A masked pattern was here ####
PREHOOK: query: analyze table over500 compute statistics
PREHOOK: type: QUERY
PREHOOK: Input: default@over500
PREHOOK: Output: default@over500
POSTHOOK: query: analyze table over500 compute statistics
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over500
POSTHOOK: Output: default@over500
PREHOOK: query: analyze table over500 compute statistics for columns t,si,i,b,f,d,bo,s
PREHOOK: type: QUERY
PREHOOK: Input: default@over500
#### A masked pattern was here ####
POSTHOOK: query: analyze table over500 compute statistics for columns t,si,i,b,f,d,bo,s
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over500
#### A masked pattern was here ####
PREHOOK: query: analyze table over2k compute statistics
PREHOOK: type: QUERY
PREHOOK: Input: default@over2k
PREHOOK: Output: default@over2k
POSTHOOK: query: analyze table over2k compute statistics
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over2k
POSTHOOK: Output: default@over2k
PREHOOK: query: analyze table over2k compute statistics for columns t,si,i,b,f,d,bo,s
PREHOOK: type: QUERY
PREHOOK: Input: default@over2k
#### A masked pattern was here ####
POSTHOOK: query: analyze table over2k compute statistics for columns t,si,i,b,f,d,bo,s
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over2k
#### A masked pattern was here ####
PREHOOK: query: analyze table over5k compute statistics
PREHOOK: type: QUERY
PREHOOK: Input: default@over5k
PREHOOK: Output: default@over5k
POSTHOOK: query: analyze table over5k compute statistics
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over5k
POSTHOOK: Output: default@over5k
PREHOOK: query: analyze table over5k compute statistics for columns t,si,i,b,f,d,bo,s
PREHOOK: type: QUERY
PREHOOK: Input: default@over5k
#### A masked pattern was here ####
POSTHOOK: query: analyze table over5k compute statistics for columns t,si,i,b,f,d,bo,s
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over5k
#### A masked pattern was here ####
PREHOOK: query: -- 3 way join on d,f,b,i
select  r1.i, r2.i, r3.i
from over10k r1 join over5k r2 join over500 r3 
on r1.d = r2.d and r1.d = r3.d and
   r1.f = r2.f and r1.f = r3.f and
   r1.bo = r2.bo and r1.bo = r3.bo and
   r1.i = r2.i and r1.i = r3.i
where  r1.i + r2.i + r3.i = (65536) * 3
PREHOOK: type: QUERY
PREHOOK: Input: default@over10k
PREHOOK: Input: default@over500
PREHOOK: Input: default@over5k
#### A masked pattern was here ####
POSTHOOK: query: -- 3 way join on d,f,b,i
select  r1.i, r2.i, r3.i
from over10k r1 join over5k r2 join over500 r3 
on r1.d = r2.d and r1.d = r3.d and
   r1.f = r2.f and r1.f = r3.f and
   r1.bo = r2.bo and r1.bo = r3.bo and
   r1.i = r2.i and r1.i = r3.i
where  r1.i + r2.i + r3.i = (65536) * 3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over10k
POSTHOOK: Input: default@over500
POSTHOOK: Input: default@over5k
#### A masked pattern was here ####
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
PREHOOK: query: -- 4 way join on compound, typecasting
select r1.i, r2.i, r3.i, r4.i
from over10k r1 join over5k r2 join over500 r3 join over2k r4 
on r1.f = r2.f and r1.d = r3.d and r2.s = r4.s and round(r1.f) = round(r4.f)
where r1.i + r2.i + r3.i + r4.i = (65536) * 4
PREHOOK: type: QUERY
PREHOOK: Input: default@over10k
PREHOOK: Input: default@over2k
PREHOOK: Input: default@over500
PREHOOK: Input: default@over5k
#### A masked pattern was here ####
POSTHOOK: query: -- 4 way join on compound, typecasting
select r1.i, r2.i, r3.i, r4.i
from over10k r1 join over5k r2 join over500 r3 join over2k r4 
on r1.f = r2.f and r1.d = r3.d and r2.s = r4.s and round(r1.f) = round(r4.f)
where r1.i + r2.i + r3.i + r4.i = (65536) * 4
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over10k
POSTHOOK: Input: default@over2k
POSTHOOK: Input: default@over500
POSTHOOK: Input: default@over5k
#### A masked pattern was here ####
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
PREHOOK: query: -- mixed types in join cond, filter
select  r1.i, r2.i, r2.d + 65659 
from over10k r1 join over5k r2  on r1.i = round(r2.d + 65600) 
where r2.i > r2.d + 65659
PREHOOK: type: QUERY
PREHOOK: Input: default@over10k
PREHOOK: Input: default@over5k
#### A masked pattern was here ####
POSTHOOK: query: -- mixed types in join cond, filter
select  r1.i, r2.i, r2.d + 65659 
from over10k r1 join over5k r2  on r1.i = round(r2.d + 65600) 
where r2.i > r2.d + 65659
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over10k
POSTHOOK: Input: default@over5k
#### A masked pattern was here ####
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
PREHOOK: query: -- group by
select r1.i, round(f/2), count(*), sum(d), avg(t), sum (d + f) 
from over10k r1   
where i = 65726 group by i, round(f/2)
PREHOOK: type: QUERY
PREHOOK: Input: default@over10k
#### A masked pattern was here ####
POSTHOOK: query: -- group by
select r1.i, round(f/2), count(*), sum(d), avg(t), sum (d + f) 
from over10k r1   
where i = 65726 group by i, round(f/2)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over10k
#### A masked pattern was here ####
65726	0.0	1	47.11	88.0	47.949999973773956
65726	1.0	1	49.4	91.0	52.31000008583069
65726	2.0	2	61.989999999999995	63.0	70.83999990463256
65726	3.0	1	22.68	35.0	29.52000015258789
65726	4.0	3	38.23	55.333333333333336	62.86000059127807
65726	5.0	1	44.64	12.0	54.15000022888184
65726	7.0	2	71.62	73.5	98.9300004196167
65726	8.0	2	68.28	91.5	100.29999950408936
65726	9.0	2	40.14	78.5	76.47999824523926
65726	11.0	3	101.86000000000001	76.0	168.5800012207031
65726	12.0	1	36.17	110.0	59.210000915527345
65726	14.0	1	34.37	58.0	62.79000007629394
65726	15.0	4	125.22	63.75	245.52999946594238
65726	16.0	1	36.05	78.0	67.89000015258789
65726	18.0	2	28.240000000000002	69.5	100.10999893188477
65726	19.0	1	4.93	65.0	42.02000015258789
65726	20.0	2	30.68	39.0	111.13999908447266
65726	21.0	2	56.31999999999999	111.0	140.11000091552734
65726	22.0	1	32.08	118.0	76.28999908447265
65726	24.0	1	37.15	59.0	86.08999862670899
65726	27.0	1	5.12	13.0	58.21000015258789
65726	28.0	2	55.8	59.0	167.61000137329103
65726	29.0	1	37.69	62.0	95.16000122070312
65726	30.0	1	28.53	28.0	88.18999984741211
65726	31.0	1	20.08	72.0	82.16000183105469
65726	32.0	1	26.26	28.0	89.46999908447266
65726	35.0	1	49.91	-2.0	120.78000274658203
65726	38.0	1	37.08	21.0	113.99000366210937
65726	41.0	2	87.53	13.0	250.30000427246094
65726	43.0	2	42.78	81.0	213.41999938964847
65726	45.0	2	46.85	53.5	225.7300048828125
65726	49.0	1	40.15	81.0	137.23999633789063
PREHOOK: query: -- compound join condition
select t1.i, t1.d, t2.i, t2.d
from over1k t1 join over1k t2 on ((t1.i+t1.d)/10)=((t2.i+t2.d)/10)
where t1.i + t2.i = (65536) * 2 and t1.d + t2.d < 3
PREHOOK: type: QUERY
PREHOOK: Input: default@over1k
#### A masked pattern was here ####
POSTHOOK: query: -- compound join condition
select t1.i, t1.d, t2.i, t2.d
from over1k t1 join over1k t2 on ((t1.i+t1.d)/10)=((t2.i+t2.d)/10)
where t1.i + t2.i = (65536) * 2 and t1.d + t2.d < 3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over1k
#### A masked pattern was here ####
65536	1.46	65536	1.46
PREHOOK: query: -- having
select r1.i, round(f/2), count(*), sum(d), avg(t), sum (d + f) 
from over10k r1   
where i = 65726 
group by i, round(f/2) 
having count(*) >= 4
PREHOOK: type: QUERY
PREHOOK: Input: default@over10k
#### A masked pattern was here ####
POSTHOOK: query: -- having
select r1.i, round(f/2), count(*), sum(d), avg(t), sum (d + f) 
from over10k r1   
where i = 65726 
group by i, round(f/2) 
having count(*) >= 4
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over10k
#### A masked pattern was here ####
65726	15.0	4	125.22	63.75	245.52999946594238
PREHOOK: query: -- limit
select r1.i, round(f/2), count(*), sum(d), avg(t), sum (d + f) 
from over10k r1   
where i = 65726 
group by i, round(f/2) 
limit 5
PREHOOK: type: QUERY
PREHOOK: Input: default@over10k
#### A masked pattern was here ####
POSTHOOK: query: -- limit
select r1.i, round(f/2), count(*), sum(d), avg(t), sum (d + f) 
from over10k r1   
where i = 65726 
group by i, round(f/2) 
limit 5
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over10k
#### A masked pattern was here ####
65726	0.0	1	47.11	88.0	47.949999973773956
65726	1.0	1	49.4	91.0	52.31000008583069
65726	2.0	2	61.989999999999995	63.0	70.83999990463256
65726	3.0	1	22.68	35.0	29.52000015258789
65726	4.0	3	38.23	55.333333333333336	62.86000059127807
