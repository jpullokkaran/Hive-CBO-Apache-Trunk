PREHOOK: query: create table over10k(
           t tinyint,
           si smallint,
           i int,
           b bigint,
           f float,
           d double,
           bo boolean,
           s string,
	   ts timestamp, 
           dec decimal(4,2),  
           bin binary)
       row format delimited
       fields terminated by '|'
PREHOOK: type: CREATETABLE
POSTHOOK: query: create table over10k(
           t tinyint,
           si smallint,
           i int,
           b bigint,
           f float,
           d double,
           bo boolean,
           s string,
	   ts timestamp, 
           dec decimal(4,2),  
           bin binary)
       row format delimited
       fields terminated by '|'
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@over10k
PREHOOK: query: load data local inpath '../../data/files/over10k' into table over10k
PREHOOK: type: LOAD
PREHOOK: Output: default@over10k
POSTHOOK: query: load data local inpath '../../data/files/over10k' into table over10k
POSTHOOK: type: LOAD
POSTHOOK: Output: default@over10k
PREHOOK: query: -- i ranges from 65536 to (65536 + 30)
-- with around 30-40 rows per value.

create table over1k as select * from over10k where i < 65536 + 30
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@over10k
POSTHOOK: query: -- i ranges from 65536 to (65536 + 30)
-- with around 30-40 rows per value.

create table over1k as select * from over10k where i < 65536 + 30
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@over10k
POSTHOOK: Output: default@over1k
PREHOOK: query: create table over500 as select * from over10k where i < 65536 + 15
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@over10k
POSTHOOK: query: create table over500 as select * from over10k where i < 65536 + 15
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@over10k
POSTHOOK: Output: default@over500
PREHOOK: query: create table over2k as select * from over10k where i < 65536 + 60
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@over10k
POSTHOOK: query: create table over2k as select * from over10k where i < 65536 + 60
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@over10k
POSTHOOK: Output: default@over2k
PREHOOK: query: create table over5k as select * from over10k where i < 65536 + 125
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@over10k
POSTHOOK: query: create table over5k as select * from over10k where i < 65536 + 125
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@over10k
POSTHOOK: Output: default@over5k
PREHOOK: query: analyze table over10k compute statistics
PREHOOK: type: QUERY
PREHOOK: Input: default@over10k
PREHOOK: Output: default@over10k
POSTHOOK: query: analyze table over10k compute statistics
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over10k
POSTHOOK: Output: default@over10k
PREHOOK: query: analyze table over10k compute statistics for columns t,si,i,b,f,d,bo,s,ts,bin
PREHOOK: type: QUERY
PREHOOK: Input: default@over10k
#### A masked pattern was here ####
POSTHOOK: query: analyze table over10k compute statistics for columns t,si,i,b,f,d,bo,s,ts,bin
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over10k
#### A masked pattern was here ####
PREHOOK: query: analyze table over1k compute statistics
PREHOOK: type: QUERY
PREHOOK: Input: default@over1k
PREHOOK: Output: default@over1k
POSTHOOK: query: analyze table over1k compute statistics
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over1k
POSTHOOK: Output: default@over1k
PREHOOK: query: analyze table over1k compute statistics for columns t,si,i,b,f,d,bo,s,ts,bin
PREHOOK: type: QUERY
PREHOOK: Input: default@over1k
#### A masked pattern was here ####
POSTHOOK: query: analyze table over1k compute statistics for columns t,si,i,b,f,d,bo,s,ts,bin
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over1k
#### A masked pattern was here ####
PREHOOK: query: analyze table over500 compute statistics
PREHOOK: type: QUERY
PREHOOK: Input: default@over500
PREHOOK: Output: default@over500
POSTHOOK: query: analyze table over500 compute statistics
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over500
POSTHOOK: Output: default@over500
PREHOOK: query: analyze table over500 compute statistics for columns t,si,i,b,f,d,bo,s,ts,bin
PREHOOK: type: QUERY
PREHOOK: Input: default@over500
#### A masked pattern was here ####
POSTHOOK: query: analyze table over500 compute statistics for columns t,si,i,b,f,d,bo,s,ts,bin
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over500
#### A masked pattern was here ####
PREHOOK: query: analyze table over2k compute statistics
PREHOOK: type: QUERY
PREHOOK: Input: default@over2k
PREHOOK: Output: default@over2k
POSTHOOK: query: analyze table over2k compute statistics
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over2k
POSTHOOK: Output: default@over2k
PREHOOK: query: analyze table over2k compute statistics for columns t,si,i,b,f,d,bo,s,ts,bin
PREHOOK: type: QUERY
PREHOOK: Input: default@over2k
#### A masked pattern was here ####
POSTHOOK: query: analyze table over2k compute statistics for columns t,si,i,b,f,d,bo,s,ts,bin
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over2k
#### A masked pattern was here ####
PREHOOK: query: analyze table over5k compute statistics
PREHOOK: type: QUERY
PREHOOK: Input: default@over5k
PREHOOK: Output: default@over5k
POSTHOOK: query: analyze table over5k compute statistics
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over5k
POSTHOOK: Output: default@over5k
PREHOOK: query: analyze table over5k compute statistics for columns t,si,i,b,f,d,bo,s,ts,bin
PREHOOK: type: QUERY
PREHOOK: Input: default@over5k
#### A masked pattern was here ####
POSTHOOK: query: analyze table over5k compute statistics for columns t,si,i,b,f,d,bo,s,ts,bin
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over5k
#### A masked pattern was here ####
PREHOOK: query: -- 3 way join on d,f,b,i
select  r1.i, r2.i, r3.i
from over10k r1 join over5k r2 join over500 r3 
on r1.d = r2.d and r1.d = r3.d and
   r1.f = r2.f and r1.f = r3.f and
   r1.bo = r2.bo and r1.bo = r3.bo and
   r1.i = r2.i and r1.i = r3.i
where  r1.i + r2.i + r3.i = (65536) * 3
PREHOOK: type: QUERY
PREHOOK: Input: default@over10k
PREHOOK: Input: default@over500
PREHOOK: Input: default@over5k
#### A masked pattern was here ####
POSTHOOK: query: -- 3 way join on d,f,b,i
select  r1.i, r2.i, r3.i
from over10k r1 join over5k r2 join over500 r3 
on r1.d = r2.d and r1.d = r3.d and
   r1.f = r2.f and r1.f = r3.f and
   r1.bo = r2.bo and r1.bo = r3.bo and
   r1.i = r2.i and r1.i = r3.i
where  r1.i + r2.i + r3.i = (65536) * 3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over10k
POSTHOOK: Input: default@over500
POSTHOOK: Input: default@over5k
#### A masked pattern was here ####
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
65536	65536	65536
PREHOOK: query: -- 4 way join on compound, typecasting
select r1.i, r2.i, r3.i, r4.i
from over10k r1 join over5k r2 join over500 r3 join over2k r4 
on r1.f = r2.f and r1.d = r3.d and r2.s = r4.s and round(r1.f) = round(r4.f)
where r1.i + r2.i + r3.i + r4.i = (65536) * 4
PREHOOK: type: QUERY
PREHOOK: Input: default@over10k
PREHOOK: Input: default@over2k
PREHOOK: Input: default@over500
PREHOOK: Input: default@over5k
#### A masked pattern was here ####
POSTHOOK: query: -- 4 way join on compound, typecasting
select r1.i, r2.i, r3.i, r4.i
from over10k r1 join over5k r2 join over500 r3 join over2k r4 
on r1.f = r2.f and r1.d = r3.d and r2.s = r4.s and round(r1.f) = round(r4.f)
where r1.i + r2.i + r3.i + r4.i = (65536) * 4
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over10k
POSTHOOK: Input: default@over2k
POSTHOOK: Input: default@over500
POSTHOOK: Input: default@over5k
#### A masked pattern was here ####
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
65536	65536	65536	65536
PREHOOK: query: -- mixed types in join cond, filter
select  r1.i, r2.i, r2.d + 65659 
from over10k r1 join over5k r2  on r1.i = round(r2.d + 65600) 
where r2.i > r2.d + 65659
PREHOOK: type: QUERY
PREHOOK: Input: default@over10k
PREHOOK: Input: default@over5k
#### A masked pattern was here ####
POSTHOOK: query: -- mixed types in join cond, filter
select  r1.i, r2.i, r2.d + 65659 
from over10k r1 join over5k r2  on r1.i = round(r2.d + 65600) 
where r2.i > r2.d + 65659
POSTHOOK: type: QUERY
POSTHOOK: Input: default@over10k
POSTHOOK: Input: default@over5k
#### A masked pattern was here ####
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
65601	65660	65659.87
